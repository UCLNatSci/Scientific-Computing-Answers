{"backend_state":"init","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-1ca94d1d-54c2-4361-a22b-873969d27df5.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.10"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"474748","input":"","pos":10,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"a9bf7f","input":"# 1\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\np = 365\nd = 1\nt = np.arange(0, 365)\nx = d * np.cos(2*np.pi*t/p)\ny = d * np.sin(2*np.pi*t/p)\n\nplt.plot(t, x)\nplt.plot(t, y)\n\nplt.figure(figsize=(4,4))\nplt.plot(x, y)","output":{"0":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x7f27db2b5a30>]"},"exec_count":2,"output_type":"execute_result"},"1":{"data":{"image/png":"a545f1dbc6f96b02f0fbcc64f0624c04d35e57fb","text/plain":"<Figure size 864x504 with 1 Axes>"},"exec_count":2,"metadata":{"image/png":{"height":411,"width":721},"needs_background":"light"},"output_type":"execute_result"},"2":{"data":{"image/png":"24792f98c32b6f435efc9d25b7f276485b4e00ce","text/plain":"<Figure size 288x288 with 1 Axes>"},"exec_count":2,"metadata":{"image/png":{"height":248,"width":275},"needs_background":"light"},"output_type":"execute_result"}},"pos":1,"type":"cell"}
{"cell_type":"code","exec_count":4,"id":"bf0d1d","input":"# 2\n\np = 365\nd = 1\nt = np.arange(0, 365)\nx = d * np.cos(2*np.pi*t/p)\ny = d * np.sin(2*np.pi*t/p)\n\nplt.plot(t, x)\nplt.plot(t, y)\n\n\nplt.figure(figsize=(4,4))\nplt.plot(x, y)\n\n\n","output":{"0":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x7f27e3371910>]"},"exec_count":4,"output_type":"execute_result"},"1":{"data":{"image/png":"a545f1dbc6f96b02f0fbcc64f0624c04d35e57fb","text/plain":"<Figure size 864x504 with 1 Axes>"},"exec_count":4,"metadata":{"image/png":{"height":411,"width":721},"needs_background":"light"},"output_type":"execute_result"},"2":{"data":{"image/png":"24792f98c32b6f435efc9d25b7f276485b4e00ce","text/plain":"<Figure size 288x288 with 1 Axes>"},"exec_count":4,"metadata":{"image/png":{"height":248,"width":275},"needs_background":"light"},"output_type":"execute_result"}},"pos":3,"type":"cell"}
{"cell_type":"code","exec_count":43,"id":"e2eccc","input":"import numpy as np\nimport matplotlib.pyplot as plt\n\n\n\nfor i in range(t_max - 1):\n    S[i+1] = S[i] - b * S[i] * I[i]\n    I[i+1] = I[i] + b * S[i] * I[i] - a * I[i]\n    \nRa = S_0 + I_0 - S - I\n    \nplt.plot(t, S)\nplt.plot(t, I)","output":{"0":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x7f50b63eef70>]"},"exec_count":43,"output_type":"execute_result"},"1":{"data":{"image/png":"de1a2aa2f15683aaf8f46eb623a1e9b03489bb85","text/plain":"<Figure size 864x504 with 1 Axes>"},"exec_count":43,"metadata":{"image/png":{"height":411,"width":723},"needs_background":"light"},"output_type":"execute_result"}},"pos":5,"type":"cell"}
{"cell_type":"code","exec_count":58,"id":"ce7785","input":"def max_I(a, b):\n    \n    t_max = 100\n    S_0 = 20000\n    I_0 = 100\n    t = np.arange(t_max)\n    S = np.zeros(t_max)\n    I = np.zeros(t_max)\n    R = np.zeros(t_max)\n\n    S[0] = S_0\n    I[0] = I_0\n    for i in range(t_max - 1):\n        S[i+1] = S[i] - b * S[i] * I[i]\n        I[i+1] = I[i] + b * S[i] * I[i] - a * I[i]\n    \n    return np.max(I)\n\n\nmax_I(0.1, 0.00005)","output":{"0":{"data":{"text/plain":"14873.5610390745"},"exec_count":58,"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":83,"id":"558944","input":"n = 100\nb_vals = np.linspace(0, 0.00006, n)\nb_vals","output":{"0":{"data":{"text/plain":"array([0.00000000e+00, 6.06060606e-07, 1.21212121e-06, 1.81818182e-06,\n       2.42424242e-06, 3.03030303e-06, 3.63636364e-06, 4.24242424e-06,\n       4.84848485e-06, 5.45454545e-06, 6.06060606e-06, 6.66666667e-06,\n       7.27272727e-06, 7.87878788e-06, 8.48484848e-06, 9.09090909e-06,\n       9.69696970e-06, 1.03030303e-05, 1.09090909e-05, 1.15151515e-05,\n       1.21212121e-05, 1.27272727e-05, 1.33333333e-05, 1.39393939e-05,\n       1.45454545e-05, 1.51515152e-05, 1.57575758e-05, 1.63636364e-05,\n       1.69696970e-05, 1.75757576e-05, 1.81818182e-05, 1.87878788e-05,\n       1.93939394e-05, 2.00000000e-05, 2.06060606e-05, 2.12121212e-05,\n       2.18181818e-05, 2.24242424e-05, 2.30303030e-05, 2.36363636e-05,\n       2.42424242e-05, 2.48484848e-05, 2.54545455e-05, 2.60606061e-05,\n       2.66666667e-05, 2.72727273e-05, 2.78787879e-05, 2.84848485e-05,\n       2.90909091e-05, 2.96969697e-05, 3.03030303e-05, 3.09090909e-05,\n       3.15151515e-05, 3.21212121e-05, 3.27272727e-05, 3.33333333e-05,\n       3.39393939e-05, 3.45454545e-05, 3.51515152e-05, 3.57575758e-05,\n       3.63636364e-05, 3.69696970e-05, 3.75757576e-05, 3.81818182e-05,\n       3.87878788e-05, 3.93939394e-05, 4.00000000e-05, 4.06060606e-05,\n       4.12121212e-05, 4.18181818e-05, 4.24242424e-05, 4.30303030e-05,\n       4.36363636e-05, 4.42424242e-05, 4.48484848e-05, 4.54545455e-05,\n       4.60606061e-05, 4.66666667e-05, 4.72727273e-05, 4.78787879e-05,\n       4.84848485e-05, 4.90909091e-05, 4.96969697e-05, 5.03030303e-05,\n       5.09090909e-05, 5.15151515e-05, 5.21212121e-05, 5.27272727e-05,\n       5.33333333e-05, 5.39393939e-05, 5.45454545e-05, 5.51515152e-05,\n       5.57575758e-05, 5.63636364e-05, 5.69696970e-05, 5.75757576e-05,\n       5.81818182e-05, 5.87878788e-05, 5.93939394e-05, 6.00000000e-05])"},"exec_count":83,"output_type":"execute_result"}},"pos":7,"type":"cell"}
{"cell_type":"code","exec_count":84,"id":"41722e","input":"peak_I = np.zeros(n)\n\nfor i in range(n):\n    b = b_vals[i]\n    peak_I[i] = max_I(a, b)\n    \npeak_I","output":{"0":{"data":{"text/plain":"array([  100.        ,   100.        ,   100.        ,   100.        ,\n         100.        ,   100.        ,   100.        ,   100.        ,\n         100.        ,   170.93458449,   414.33841644,   792.90614464,\n        1213.87364878,  1662.18776303,  2119.98716215,  2577.08938258,\n        3025.55285586,  3462.88882212,  3885.84027034,  4292.98419294,\n        4688.28495483,  5062.75350781,  5426.01737762,  5773.23150906,\n        6111.76119541,  6425.97084103,  6740.39549649,  7036.53753549,\n        7319.44443509,  7592.48457515,  7857.05717632,  8112.32408279,\n        8354.896514  ,  8578.4433711 ,  8813.57102946,  9039.64066918,\n        9230.25940159,  9456.41354116,  9642.05106295,  9845.64697276,\n       10017.72971045, 10214.84340469, 10355.96117578, 10561.3060704 ,\n       10708.33609866, 10870.56140408, 11043.43822296, 11164.85412559,\n       11325.10316294, 11487.74370716, 11604.1561051 , 11721.59171441,\n       11893.74320281, 12023.50128675, 12113.56174005, 12233.00952243,\n       12393.79148886, 12517.00173848, 12604.89712853, 12660.21185477,\n       12823.64050248, 12963.57155727, 13070.92236211, 13147.65923466,\n       13196.10145936, 13304.93191026, 13453.77372113, 13573.28402477,\n       13664.80189357, 13730.00056397, 13770.81704885, 13802.16258647,\n       13961.03060116, 14093.81711035, 14201.26910263, 14284.43351175,\n       14344.61997279, 14383.35702494, 14402.34369635, 14426.93308815,\n       14582.53178125, 14715.54528602, 14826.32921049, 14915.47498229,\n       14983.79572889, 15032.30694965, 15062.20245891, 15074.82627489,\n       15071.64130547, 15088.99472693, 15246.0017288 , 15383.80596796,\n       15502.3714254 , 15601.82642714, 15682.46447976, 15744.74246362,\n       15789.27607821, 15816.83249285, 15828.32022102, 15824.77630707])"},"exec_count":84,"output_type":"execute_result"}},"pos":8,"type":"cell"}
{"cell_type":"code","exec_count":85,"id":"aa4594","input":"plt.plot(b_vals, peak_I)","output":{"0":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x7f50b6206e80>]"},"exec_count":85,"output_type":"execute_result"},"1":{"data":{"image/png":"9b1b9d89966abb75118c039db7f32433b09aabbc","text/plain":"<Figure size 864x504 with 1 Axes>"},"exec_count":85,"metadata":{"image/png":{"height":423,"width":723},"needs_background":"light"},"output_type":"execute_result"}},"pos":9,"type":"cell"}
{"cell_type":"markdown","id":"217f95","input":"","pos":2,"type":"cell"}
{"cell_type":"markdown","id":"89edb6","input":"The spread of an infectious disease amongst a population can be modelled by the SIR model. The number of susceptible ($S_i$) and infected ($I_i$) peeople are modelled by the following pair of coupled equations:\n\n$$ S_{i+1} = S_i - bS_iI_i $$\n$$ I_{i+1} = I_i + bS_iI_i - aI_i $$\n\nwhere $i$ represents the number of days since the start of the outbreak. There are two parameters: the recovery rate parameter $a$ and the infection rate parameter $b$.\n\n1. With parameter values $a = 0.1$ and $b = 0.00005$ and the initial populations $S_0 = 20000$ and $I_0 = 100$, simulate the infection for a duration 100 days. Plot the resulting arrays `S` and `I` on the same figure. [You should see that the number of infected people peaks at around 15000 at about day 15, while the number of susceptible people drops to about zero at about the same time].\n\nThe number of recovered people $R_i$ is given by $P = S_i + I_i + R_i$ where the total population $P$ is a constant.\n\n2. Given the total population $P = S_0 + I_0$, calculate an array `R` representing the number of recovered people over the 100 days. Plot `R` on the graph together with `S` and `I`.\n\nThe infection rate parameter $b$ can be influenced by public policy - for example the imposition of social distancing, vaccination or other measures. \n\n3. Experiment with various values of $b$ to see how it affects the outbreak. Roughly what is the minimum value of $b$ which results in an epidemic? (We say there is an epidemic if $I_i$ initially rises to a peak, however small).\n\nThe Government would like to understand how $b$ affects the the peak value of $I_i$. \n\n4. Write a function `max_I(a, b)` which runs the simulation with the given values for the parameters $a$ and $b$ and returns the maximum value of `I_i`. Then, write a loop which calculates `max_I(a, b)` for values of `b` ranging from 0.0 to 0.00005. Plot a graph showing peak $I_i$ against $b$.\n\n```\ndef max_I(a, b):\n    \n    # run the simulation for parameter values a, b\n    \n    # return maximum value of I\n```","pos":4,"type":"cell"}
{"cell_type":"markdown","id":"977fcd","input":"# Tutorial 5\n\n## Question 1\n\nThe (approximate) orbit of a planet around the sun is given by the following equations:\n\n$$x = d\\cos(2\\pi t/p)\\\\\n y = d\\sin(2\\pi t/p)$$\n \nwhere $d$ is the distance from the sun, and $p$  is the orbital period in days.\n \nValues for $d$ and $p$ for the Solar System can be found in the following link:\n\nhttp://www.astronomynotes.com/tables/tablesb.htm\n\n:::{sidebar} Animation Code\n```\nfrom matplotlib import animation\nfrom IPython.display import HTML, display\nimport random\n\n# Parabolic Trajectory\n\nt = np.arange(10)\ny = 25 - (t-5)**2\n\n# Animation code:\n\nfilename = \"animation.gif\"\nframes = len(t)\ninterval = 100\n\ndef ganimate(frame):\n    plt.cla()\n    plt.scatter(t[frame], y[frame])\n    plt.xlim(0, 10)\n    plt.ylim(0, 30)\n    \nfig = plt.figure(figsize=(5, 5))\nanim = animation.FuncAnimation(fig, ganimate, frames=frames, interval=interval)\nanim.save(filename, writer='imagemagick')\nplt.close()\n\n__counter__ = str(random.randint(0,2e9))\ndisplay(HTML('<img src=\"' + filename + '?' + __counter__ + '\">'))\n```\n:::\n \n1. Calculate the trajectory of planet Earth's orbit around the sun for one (Earth) year. Plot a graph showing $x$ and $y$ against $t$, and  another graph showing $y$ against $x$.\n1. Calculate the trajectories of the four innermost planets around the sun, and add their trajectories to the graphs (or course you'll have to increase the simulation duration). [hint: you could create separate variables `x_earth`, `y_earth`, `x_mercury`, `y_mercury` etc, but it is neater to make two 2-dimensional arrays `x` and `y` where each row corresponds to a planet].\n1. Adapt the animation code to generate an animation of the orbits of the four planets. [Hit: Generating the animation is slow, so try reducing the number of ]","pos":0,"type":"cell"}
{"id":0,"time":1637340741218,"type":"user"}
{"last_load":1637340741679,"type":"file"}